<div class = "container container-fluid">

  <div class="row m-5">

    <h1 class="pb-2"><strong>Je peux...</strong></h1>

    <% if @humeur.missions.exists? %>
      <%# mission = @humeur.missions.map { |mission| mission }.sample %>
        <div>
          <h1 class="mt-5"><%= @mission.content %></h1>
        </div>

      <% if !@mission.done %>
        <div>
          <div data-controller = "hello"
            class="mt-5 row d-flex h6">
            <%= form_with(model: @mission, class:"h6") do |form| %>
              <%= form.check_box :done,
                                data: {
                                  id: @mission.id,
                                  action: "hello#toggle"
                                }%>
                                C'est fait bébé !
            <% end %>
          </div>
        </div>
      <% end %>

      <% if @mission.link && !@mission.photos.attached? %>

        <div>
          <h3 class="mt-5"><strong><%= link_to '... ici', @mission.link %></strong></h3>
        </div>

      <% elsif @mission.address %>

        <div>
          <h4 class=""><%= @mission.address %></h4>
        </div>

      <% elsif @mission.address %>

        <div style="width: 100%; height: 600px;"
          data-controller="map"
          data-map-markers-value="<%= @markers.to_json %>"
          data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>

      <% elsif @mission.video %>

        <div>
          <iframe class="mt-3" width="560" height="315" src=<%= @mission.video %> frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>

      <% elsif @mission.photos.attached? %>

        <div>
          <h1 class="mt-3"><%= link_to cl_image_tag(@mission.photos.first.key, class: "mission-photo"), @mission.link %></h1>
        </div>

      <% end %>

    <% else %>

      <div>
        <h4 class=""><%= link_to "Il n'y a pas encore d'mission associée à cette humeur", new_humeur_mission_path(@humeur)%>.</h4>
      </div>

    <% end %>

    <div class="fixed-bottom" data-controller="hello">
      <h3 id="word" class="mb-5 me-5 d-flex align-items-end flex-column"><%= link_to ":) j'ai changé d'humeur.", humeurs_path %></h3>
    </div>

  </div>

</div>
